Lingo Leap 要件定義書

1. はじめに
   本ドキュメントは、英語学習チャット UI システム「Lingo Leap」の開発における要件を定義するものです。Lingo Leap は、Gemini のようなチャット UI を通じて、ユーザーが AI との対話形式で英語学習を進められることを目的とします。
2. システム概要
   Lingo Leap は、AI とのチャットを通じてユーザーが英語を学習できる Web アプリケーションまたはモバイルアプリケーションです。ユーザーは AI からのメッセージに対して、学びたい内容を送信することで、その内容に関連する複数の英語表現や例文を提示されます。これらのメッセージには音声再生機能とブックマーク機能が備わっており、効果的な学習をサポートします。
3. 機能要件
   3.1. ユーザーインターフェース (UI)
   チャット UI:
   Gemini のような対話型のチャット UI を採用します。
   AI からのメッセージとユーザーからのメッセージが明確に区別できるように表示されます。
   メッセージ表示:
   AI からのメッセージは、ユーザーが学びたい内容を送信した後に、それぞれ別の吹き出しで 3 つ表示されます。
   各吹き出しには以下のアイコンが表示されます。
   音声アイコン
   ブックマークアイコン
   3.2. コア機能
   AI との対話:
   AI は、ユーザーが入力した「学びたい内容」に基づいて、関連性の高い英語のメッセージ（単語、フレーズ、例文など）を生成し、3 つの異なる吹き出しで提示します。
   AI は、自然な対話の流れを維持し、ユーザーの学習レベルや興味に応じた内容を提供します。
   音声再生機能 (発音確認):
   各吹き出しに表示される音声アイコンをタップまたはクリックすることで、該当する英語メッセージのネイティブスピーカーによる発音を再生します。
   再生停止、リピート再生などの基本的な操作が可能です。
   ブックマーク機能:
   各吹き出しに表示されるブックマークアイコンをタップまたはクリックすることで、該当する英語メッセージを「ブックマーク英語一覧」に保存します。
   ブックマークされた内容は、後からいつでも閲覧・学習できます。
   ブックマーク管理:
   「ブックマーク英語一覧」画面を提供します。
   一覧からブックマークされた英語メッセージを削除する機能を提供します。
   削除操作時には、モーダルダイアログなどを表示し、ユーザーに削除の意思を確認します。
   3.3. ユーザー管理（仮）
   ユーザーはアカウントを作成し、ログインして学習データを永続化できるものとします。（今後の拡張として検討）

   学習履歴:
   ユーザーの学習行動（例: AI 応答生成、音声再生、ブックマーク追加/削除、ブックマーク一覧閲覧）を自動で履歴として記録します。
   記録された履歴は「学習履歴」画面から一覧で閲覧でき、期間やイベント種別でフィルタ可能とします。
   可視化 UI（折れ線/棒/円グラフ等）で期間内の件数推移・イベント内訳を表示します。
   コホート/リテンション分析（週次/日次）により継続率や復習行動を可視化します。

4. 非機能要件
   4.1. パフォーマンス
   AI からのメッセージ生成、音声再生、ブックマーク保存/表示は、ユーザーがストレスなく利用できる速度で応答すること。
   特に AI からの 3 つのメッセージ生成は、数秒以内に完了することを目標とします。集計/可視化 API は 95 パーセンタイルで < 500ms を目標とします（マテビュー/キャッシュ活用）。
   4.2. スケーラビリティ
   将来的なユーザー数の増加や機能拡張に対応できるよう、拡張性のあるアーキテクチャ設計とします。
   4.3. セキュリティ
   ユーザーの個人情報や学習データは適切に保護されること。
   SSL/TLS による通信の暗号化を必須とします。
   4.4. ユーザビリティ
   直感的で分かりやすい UI/UX を提供し、英語学習が楽しく継続できるような体験を目指します。
   アクセシビリティにも配慮します。
   4.5. 信頼性
   システムは安定稼働し、サービス中断は最小限に抑えられること。
   障害発生時には、迅速な復旧が可能な体制を構築します。
5. 技術要件（選定技術）
   5.1. フロントエンド
   Next.js（App Router）+ TypeScript を採用します。UI フレームワークとして Tailwind CSS を想定します。

   - ルーティング: Next.js App Router
   - 状態管理: 軽量なローカルステート（必要に応じて React Query など）
   - 音声再生: ブラウザの Audio API を基本とし、TTS 生成音声の再生に対応

     5.2. バックエンド（API）
     Next.js の Route Handlers（Edge/Node ランタイム）を用いて API を実装します。

   - AI 応答生成: ai-sdk を利用して LLM（例: OpenAI/Gemini 等）にリクエスト
   - レート制御/ストリーミング: ai-sdk のストリーミング応答に対応

     5.3. 認証/データベース
     Supabase を採用します。

   - 認証: Supabase Auth（メール/パスワード、OAuth など）
<<<<<<< HEAD
   - データベース: Supabase Postgres（ブックマーク、学習履歴の永続化）
=======
   - データベース: Supabase Postgres（ブックマーク、学習履歴等の永続化）
>>>>>>> 5a7a6fc3d20a7c8a301dee44a3d1b9bd1dfe3853
   - API アクセス: Supabase JavaScript SDK による RLS 前提の安全なアクセス

     5.4. AI/ML
     ai-sdk を通じて選定 LLM の API と連携します。

   - モデル切替: 環境変数によりプロバイダ/モデルを切替可能に設計
   - 生成内容: ユーザー入力に基づき英語表現を 3 通り生成

     5.5. 音声合成（TTS）
     初期はブラウザの読み上げ/外部 TTS API のいずれかを使用可能とします（将来拡張）。

   - 候補: Vercel AI SDK 経由での TTS、あるいは外部サービス（例: ElevenLabs, Azure TTS 等）

     5.6. デプロイ/ホスティング

   - アプリ: Vercel にデプロイ（Preview/Production 環境）
   - データベース/認証: Supabase プロジェクトにホスト
   - 監視: Vercel Analytics（必要に応じて追加の監視を導入）

     5.7. アーキテクチャ概要

   - フロントエンド（Next.js）から Route Handler 経由で ai-sdk を呼び出し、3 件の英語メッセージを生成
   - ブックマーク操作はフロントエンドから Supabase に対して実施（RLS/ポリシーによりユーザー毎に保護）
   - 認証は Supabase Auth を利用し、ログイン状態に応じた表示/保存を制御
<<<<<<< HEAD
   - 学習履歴はフロントエンドから API 経由で記録し、Supabase に保存（RLS によりユーザー毎に保護）
   - 可視化/統計/リテンションは Supabase のビュー/マテリアライズドビューの集計を API から提供
=======
>>>>>>> 5a7a6fc3d20a7c8a301dee44a3d1b9bd1dfe3853

     5.8. 環境変数（例）

   - LLM プロバイダ鍵: AI_PROVIDER_API_KEY
   - Supabase: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY
   - 任意: TTS プロバイダ鍵（採用時）

6. 今後の展望・考慮事項
   学習履歴の高度な可視化（グラフ/リテンション分析）
   レベルに応じた学習コンテンツのパーソナライズ
   クイズ機能
   コミュニティ機能
   多言語対応
